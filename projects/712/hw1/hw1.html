<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
		<title>Animation!</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <div class="topnav">
        <a href="../../index.html">Home</a>
        <a class="active" href="../projects.html">Projects</a>
        <a href="https://www.linkedin.com/in/patrick-ribas/">LinkedIn</a>
        <a href="../../Patrick_Ribas_Resume.pdf">Resume</a>
        <a href="../../contact.html">Contact</a>
    </div>
    <div class="title">
        CSCI 712: Animation HW 1
    </div>
    <script src="../js/three.js"></script>
        <style>
            body { text-align: center; }
        </style>
		<script>

            let text = "";
            function set(a){
                text = a;
            }
            
			// Our Javascript will go here.
            const test = fetch("https://patribas.github.io/projects/712/hw1/keyframe-input.txt")
                .then(req => req.text())
                .then(text => set(text));

            const scene = new THREE.Scene();
            const camera = new THREE.PerspectiveCamera( 75, 1, 0.1, 1000 );
            
            const renderer = new THREE.WebGLRenderer();
            renderer.setSize( 512, 512 );
            document.body.appendChild( renderer.domElement );

            var n = 7;
            const geometry = new THREE.BoxGeometry(n, n, n);
            const material = new THREE.MeshBasicMaterial( { color: 0xffff00 } );
            const cube = new THREE.Mesh( geometry, material );
            scene.add( cube );

            var edges = new THREE.EdgesHelper( cube, 0x0000ff);
            edges.material.linewidth = 2;
            scene.add(edges); 

            camera.position.z = 15 * 5;
            camera.position.x = 50;
            camera.position.y = 50;

            var init_time = new Date();
            var t = 0;
            var keyframes = null;

            function parse_keyframe_info( data )
            {
                var lines = data.split('\n');
                var frames = [];
                for ( var i = 0; i < lines.length; i += 1 )
                {
                    var cur_data = lines[i].split(/[ ]+/);
                    var cur_frame = [];
                    for ( var j = 0; j < cur_data.length; j += 1 )
                    {
                        cur_frame.push( Number(cur_data[j]) );
                    }
                    frames.push( cur_frame );
                }
                return frames;
            }


            function animate() {
                requestAnimationFrame( animate );
                if ( text == "" )
                {
                    // since javascript is uh, not exactly designed for reading files
                    // we have to make sure that our asynchronous text reader
                    // has actually completed
                    // before we crash something in three.js
                    renderer.render( scene, camera );
                }
                else
                {
                    if ( keyframes == null )
                    {
                        keyframes = parse_keyframe_info( text );
                        console.log(keyframes);
                    } 
                    temp_date = new Date();
                    t = (temp_date.getTime() - init_time.getTime()) / 1000;
                    cube.position.x += 1;
                    edges.position.x += 1;
                    renderer.render( scene, camera );
                }
            }
            animate();

		</script>
    <div class="main">
        Lorem ipsum
    </div>
</body>
</html>
